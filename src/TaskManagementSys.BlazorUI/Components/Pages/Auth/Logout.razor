@page "/logout"
@using TaskManagementSys.BlazorUI.Services
@inject AuthService AuthService
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthStateProvider

<PageTitle>Logout</PageTitle>

<div class="d-flex justify-content-center align-items-center" style="height: 70vh;">
    <div class="text-center">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3">Logging out...</p>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            await AuthService.LogoutAsync();
            await ((CustomAuthStateProvider)AuthStateProvider).UpdateAuthenticationState(null);
            Navigation.NavigateTo("/login");
        }
        catch
        {
            // Even if API call fails, clear local session
            await ((CustomAuthStateProvider)AuthStateProvider).UpdateAuthenticationState(null);
            Navigation.NavigateTo("/login");
        }
    }
} 